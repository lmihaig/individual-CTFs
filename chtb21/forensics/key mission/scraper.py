from scapy.all import *  
mapping = {0x0: "", 0x04  :"a", 0x05  :"b", 0x06  :"c", 0x07  :"d", 0x08  :"e", 0x09  :"f", 0x0A  :"g", 0x0B  :"h", 0x0C  :"i", 0x0D  :"j", 0x0E  :"k", 0x0F  :"l", 0x10  :"m", 0x11  :"n", 0x12  :"o", 0x13  :"p", 0x14  :"q", 0x15  :"r", 0x16  :"s", 0x17  :"t", 0x18  :"u", 0x19  :"v", 0x1A  :"w", 0x1B  :"x", 0x1C  :"y", 0x1D  :"z", 0x1E  :"1", 0x1F  :"2", 0x20  :"3", 0x21  :"4", 0x22  :"5", 0x23  :"6", 0x24  :"7", 0x25  :"8", 0x26  :"9", 0x27  :"0", 0x28  :"Return", 0x29  :"ESCAPE", 0x2A  :'\b', 0x2B  :"Tab", 0x2C  :" ", 0x2D  :"_", 0x2E  :"=", 0x2F  :"{", 0x30  :"}", 0x31  :"\and", 0x32  :"Non-US", 0x33  :";", 0x34  :"‘", 0x35  :"Grave", 0x36  :",", 0x37  :".", 0x38  :"/", 0x39  :"Caps", 0x3A  :"F1", 0x3B  :"F2", 0x3C  :"F3", 0x3D  :"F4", 0x3E  :"F5", 0x3F  :"F6", 0x40  :"F7", 0x41  :"F8", 0x42  :"F9", 0x43  :"F10", 0x44  :"F11", 0x45  :"F12", 0x46  :"PrintScreen7", 0x47  :"Scroll", 0x48  :"Pause7", 0x49  :"Insert7", 0x4A  :"Home7", 0x4B  :"PageUp7", 0x4C  :"Delete", 0x4D  :"End7", 0x4E  :"PageDown7", 0x4F  :"RightArrow7", 0x50  :"LeftArrow7", 0x51  :"DownArrow7", 0x52  :"UpArrow7", 0x53  :"Num", 0x54  :"/7", 0x55  :"*", 0x56  :"-", 0x57  :"+", 0x58  :"ENTER3", 0x59  :"1", 0x5A  :"2", 0x5B  :"3", 0x5C  :"4", 0x5D  :"5", 0x5E  :"6", 0x5F  :"7", 0x60  :"8", 0x61  :"9", 0x62  :"0", 0x63  :".", 0x64  :"Non-US", 0x65  :"Application11", 0x66  :"Power1", 0x67  :"=", 0x68  :"F13", 0x69  :"F14", 0x6A  :"F15", 0x6B  :"F16", 0x6C  :"F17", 0x6D  :"F18", 0x6E  :"F19", 0x6F  :"F20", 0x70  :"F21", 0x71  :"F22", 0x72  :"F23", 0x73  :"F24", 0x74  :"Execute", 0x75  :"Help", 0x76  :"Menu", 0x77  :"Select", 0x78  :"Stop", 0x79  :"Again", 0x7A  :"Undo", 0x7B  :"Cut", 0x7C  :"Copy", 0x7D  :"Paste", 0x7E  :"Find", 0x7F  :"Mute", 0x80  :"Volume", 0x81  :"Volume", 0x82  :"Locking", 0x83  :"Locking", 0x84  :"Locking", 0x85  :"Comma13", 0x86  :"Equal", 0x87  :"International115,16", 0x88  :"International217", 0x89  :"International318", 0x8A  :"International419", 0x8B  :"International520", 0x8C  :"International621", 0x8D  :"International722", 0x8E  :"International823", 0x8F  :"International923", 0x90  :"LANG124", 0x91  :"LANG225", 0x92  :"LANG326", 0x93  :"LANG427", 0x94  :"LANG528", 0x95  :"LANG629", 0x96  :"LANG729", 0x97  :"LANG829", 0x98  :"LANG929", 0x99  :"Alternate", 0x9A  :"SysReq/Attention7", 0x9B  :"Cancel", 0x9C  :"Clear", 0x9D  :"Prior", 0x9E  :"Return", 0x9F  :"Separator", 0xA0  :"Out", 0xA1  :"Oper", 0xA2  :"Clear/Again", 0xA3  :"CrSel/Props", 0xA4  :"ExSel", 0xA5 :"Reserve", 0xB0  :"00", 0xB1  :"000", 0xB2 :"Thousands", 0xB3 :"Decimal", 0xB4 :"Currency", 0xB5 :"Currency", 0xB6  :"(", 0xB7  :")", 0xB8  :"{", 0xB9  :"}", 0xBA  :"Tab", 0xBB  :"Backspace", 0xBC  :"A", 0xBD  :"B", 0xBE  :"C", 0xBF  :"D", 0xC0  :"E", 0xC1  :"F", 0xC2  :"XOR", 0xC3  :"∧", 0xC4  :"%", 0xC5  :"<", 0xC6  :">", 0xC7  :"&", 0xC8  :"&&", 0xC9  :"|", 0xCA  :"||", 0xCB  :":", 0xCC  :"#", 0xCD  :"Space", 0xCE  :"@", 0xCF  :"!", 0xD0  :"Memory", 0xD1  :"Memory", 0xD2  :"Memory", 0xD3  :"Memory", 0xD4  :"Memory", 0xD5  :"Memory", 0xD6  :"Memory", 0xD7  :"+/-", 0xD8  :"Clear", 0xD9  :"Clear", 0xDA  :"Binary", 0xDB  :"Octal", 0xDC  :"Decimal", 0xDD  :"Hexadecimal", 0xDE :"Reserve", 0xE0  :"LeftControl", 0xE1  :"LeftShift", 0xE2  :"LeftAlt", 0xE3  :"Left", 0xE4  :"RightControl", 0xE5  :"RightShift", 0xE6  :"RightAlt", 0xE7  :"Right", 0xE8 :"Reserve"}   
packets  = rdpcap("key_mission.pcap") 

flag = []
for packet in packets:
    cap = packet[0].load[-8]
    char = packet[0].load[-6]
    if cap:
        flag.append((mapping[char]).upper())
    else:
        flag.append((mapping[char]))

print("".join(flag))